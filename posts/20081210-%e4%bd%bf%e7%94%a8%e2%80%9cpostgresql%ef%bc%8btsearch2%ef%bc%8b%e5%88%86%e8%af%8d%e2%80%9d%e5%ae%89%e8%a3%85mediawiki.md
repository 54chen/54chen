title: 使用“PostgreSQL＋tsearch2＋分词”安装MediaWiki
link: http://www.54chen.com/life/%e4%bd%bf%e7%94%a8%e2%80%9cpostgresql%ef%bc%8btsearch2%ef%bc%8b%e5%88%86%e8%af%8d%e2%80%9d%e5%ae%89%e8%a3%85mediawiki.html
author: cc0cc
description: 
post_id: 280
created: 2008/12/10 10:59:26
created_gmt: 2008/12/10 02:59:26
comment_status: open
post_name: %e4%bd%bf%e7%94%a8%e2%80%9cpostgresql%ef%bc%8btsearch2%ef%bc%8b%e5%88%86%e8%af%8d%e2%80%9d%e5%ae%89%e8%a3%85mediawiki
status: private
post_type: post

# 使用“PostgreSQL＋tsearch2＋分词”安装MediaWiki

_**台：RHEL5_i386**_ $ sudo useradd -s /bin/bash postgres   _**一、下载软件**_ Apache2.2：<http://httpd.apache.org/download.cgi> PHP5.2：<http://au.php.net/get/php-5.2.1.tar.bz2/from/a/mirror> PostgreSQL8.2：<http://www.postgresql.org/ftp/source/v8.2.4/> MediaWiki：<http://www.mediawiki.org/wiki/Download>   _**二、安装配置**_ _1、PostgreSQL_ $ tar jxf postgresql-8.2.4.tar.bz2 $ cd postgresql-8.2.4 $ ./configure --prefix=/home/es --enable-integer-datetimes --with-perl --with-python --with-openssl --enable-cassert --enable-debug $ gmake $ sudo gmake install $ cd contrib/tsearch2 $ gmake $ sudo gmake install $ sudo cp tsearch2.sql /tmp $ su - postgres $ /home/es/bin/initdb -D /home/es/var/data/pgsql --locale zh_CN.utf8 --encoding utf8 $ /home/es/bin/postgres -D /home/es/var/data/pgsql >/home/es/var/log/postgresql/pgsql.`date +%Y%m%d-%H`.log 2>&1 & $ createuser -P mediawiki $ createdb mediawiki $ psql -d mediawiki -f /tmp/tsearch2.sql $ psql -d mediawiki 

  * 进入后请执行如下sql语句：
insert into pg_ts_cfg (ts_name, prs_name, locale) values ('utf8_chinese', 'default', 'zh_CN.utf8'); insert into pg_ts_cfgmap(ts_name,tok_alias, dict_name) values('utf8_chinese', 'lword', '{en_stem}'); insert into pg_ts_cfgmap(ts_name,tok_alias, dict_name) values('utf8_chinese', 'nlword', '{ru_stem_utf8}'); insert into pg_ts_cfgmap(ts_name,tok_alias, dict_name) values('utf8_chinese', 'word', '{ru_stem_utf8}'); insert into pg_ts_cfgmap(ts_name,tok_alias, dict_name) values('utf8_chinese', 'email', '{simple}'); insert into pg_ts_cfgmap(ts_name,tok_alias, dict_name) values('utf8_chinese', 'url', '{simple}'); insert into pg_ts_cfgmap(ts_name,tok_alias, dict_name) values('utf8_chinese', 'host', '{simple}'); insert into pg_ts_cfgmap(ts_name,tok_alias, dict_name) values('utf8_chinese', 'sfloat', '{simple}'); insert into pg_ts_cfgmap(ts_name,tok_alias, dict_name) values('utf8_chinese', 'version', '{simple}'); insert into pg_ts_cfgmap(ts_name,tok_alias, dict_name) values('utf8_chinese', 'part_hword', '{simple}'); insert into pg_ts_cfgmap(ts_name,tok_alias, dict_name) values('utf8_chinese', 'nlpart_hword', '{ru_stem_utf8}'); insert into pg_ts_cfgmap(ts_name,tok_alias, dict_name) values('utf8_chinese', 'lpart_hword', '{en_stem}'); insert into pg_ts_cfgmap(ts_name,tok_alias, dict_name) values('utf8_chinese', 'hword', '{ru_stem_utf8}'); insert into pg_ts_cfgmap(ts_name,tok_alias, dict_name) values('utf8_chinese', 'lhword', '{en_stem}'); insert into pg_ts_cfgmap(ts_name,tok_alias, dict_name) values('utf8_chinese', 'nlhword', '{ru_stem_utf8}'); insert into pg_ts_cfgmap(ts_name,tok_alias, dict_name) values('utf8_chinese', 'uri', '{simple}'); insert into pg_ts_cfgmap(ts_name,tok_alias, dict_name) values('utf8_chinese', 'file', '{simple}'); insert into pg_ts_cfgmap(ts_name,tok_alias, dict_name) values('utf8_chinese', 'float', '{simple}'); insert into pg_ts_cfgmap(ts_name,tok_alias, dict_name) values('utf8_chinese', 'int', '{simple}'); insert into pg_ts_cfgmap(ts_name,tok_alias, dict_name) values('utf8_chinese', 'uint', '{simple}'); _2、Apache_ $ tar jxvf httpd-2.2.4.tar.bz2 $ cd httpd-2.2.4 $ ./configure --prefix=/home/es --sysconfdir=/home/es/etc/apache2 --enable-rewrite --enable-ssl --enable-expires --enable-cgi --enable-cgid --enable-vhost-alias --with-ssl=/usr $ gmake $ sudo gmake install _3、PHP_ $ tar jxvf php-5.2.1.tar.bz2 $ cd php-5.2.1 $ ./configure --prefix=/home/es --sysconfdir=/home/es/etc/php --with-config-file-path=/home/es/etc/php \ \--disable-ipv6 --enable-sockets --with-pgsql=/home/es --enable-zend-multibyte --with-apxs2=/home/es/bin/apxs \ \--with-gettext --enable-ftp --with-bz2 --with-mhash=/home/es --enable-wddx --enable-pcntl --enable-sigchild \ \--with-iconv --enable-exif --with-exif --enable-sockets --enable-memcache --enable-mbstring --enable-track-vars \ \--with-zlib=/usr --with-jpeg-dir=/usr --with-gd=/usr --with-freetype-dir=/usr --with-png-dir=/usr \ \--with-pcre-dir=/usr --openssl-dir=/usr $ gmake $ sudo gmake install $ sudo cp php.ini-dist /home/es/etc/php/php.ini _添加“AddType application/x-httpd-php .php”到httpd.conf中即可。_ $ /home/es/bin/pecl download apc $ /home/es/bin/pecl download memcache $ /home/es/bin/pecl download pecl_http $ tar zxvf APC-3.0.14.tgz $ tar zxvf memcache-2.1.2.tgz $ tar zxvf pecl_http-1.5.3.tgz $ cd APC-3.0.14 $ /home/es/bin/phpize $ ./configure --prefix=/home/es && gmake && sudo gmake install $ cd memcache-2.1.2 $ /home/es/bin/phpize $ ./configure --prefix=/home/es && gmake && sudo gmake install $ cd pecl_http-1.5.3 $ /home/es/bin/phpize $ ./configure --prefix=/home/es && gmake && sudo gmake install $ sudo mv /home/es/lib/php/extensions/no-debug-non-zts-20060613/* /home/es/lib/php/extensions/ 

  * 将以下内容加入到php.ini中：
extension_dir = "/home/es/lib/php/extensions" extension=apc.so extension=http.so extension=memcache.so apc.enabled=1 apc.shm_segments=1 apc.shm_size=32 apc.optimization=0 apc.num_files_hint=1000 apc.ttl=0 apc.gc_ttl=3600 apc.cache_by_default=1 apc.filters=NULL apc.mmap_file_mask=NULL apc.slam_defense=0 apc.file_update_protection=2 apc.enable_cli=0 apc.max_file_size=1 apc.stat=1 _4、MediaWiki_ $ wget <http://download.wikimedia.org/mediawiki/1.9/mediawiki-1.9.3.tar.gz> $ tar zxvf mediawiki-1.9.3.tar.gz $ sudo mv mediawiki-1.9.3 /home/es/htdocs/mediawiki 访问[http://服务器的IP/mediawiki/，按照提示一步一步安装即可。](http://xn--ip-fr5c86lx7z0gv/mediawiki/%EF%BC%8C%E6%8C%89%E7%85%A7%E6%8F%90%E7%A4%BA%E4%B8%80%E6%AD%A5%E4%B8%80%E6%AD%A5%E5%AE%89%E8%A3%85%E5%8D%B3%E5%8F%AF%E3%80%82)